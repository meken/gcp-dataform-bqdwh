config {
    type: "table",
    schema: "dwh",
    tags: ["obt"]
}
SELECT
  a.* EXCEPT(address_key),
  d.* EXCEPT(date_key),
  p.* EXCEPT(product_key),
  cc.* EXCEPT(credit_card_key),
  o.* EXCEPT(order_status_key),
  c.* EXCEPT(customer_key),
  f.* EXCEPT(sales_key, customer_key, order_date_key, order_status_key, credit_card_key, ship_address_key, product_key)
FROM
  ${ref("fact_sales")} f,
  ${ref("dim_address")} a,
  ${ref("dim_date")} d,
  ${ref("dim_product")} p,
  ${ref("dim_credit_card")} cc,
  ${ref("dim_order_status")} o,
  ${ref("dim_customer")} c
WHERE
  f.product_key = p.product_key
  AND f.customer_key = c.customer_key
  AND f.credit_card_key = cc.credit_card_key
  AND f.order_status_key = o.order_status_key
  AND f.ship_address_key = a.address_key
  AND f.order_date_key = d.date_key